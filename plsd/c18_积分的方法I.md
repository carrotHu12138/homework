[TOC]
#普林斯顿微积分
##第18章 积分的方法$\,{\rm I}$
- 换元法(也可以叫变量替换);
- 分部积分;
- 使用部分分式对有理函数求积分.

### 18.1 换元法
$$
\begin{array}{||}
\hline
\int \frac{f^{\prime}(x)}{f(x)} {\rm d}x= \ln|f(x)| + C.\\
\hline
\end{array}
$$

#### 18.1.1 换元法和定积分
$$
\int_0^{\sqrt[3]{\pi/2}}x^2\cos(x^3){\rm d}x.
$$
另一个方法!在整个计算过程中你都一直计算定积分,但一定要记住,把积分的上下限也用变量$\,t\,$表示.我们在例子中,用$\,t = x^3\,$云换元,然后使用$\,\cfrac{1}{3}{\rm d}t = x^2{\rm d}x\,$换到以变量$\,t\,$的积分.现在当$\,x = 0\,$时,我们有$\,t = 0^3 = 0\,$,所以积分下限为$\,0\,$.但对于积分上限,当$\,x = \sqrt[3]{\pi/2}\,$时,我们有$\,t = (\sqrt[3]{\pi/2})^3 = {\pi/2}\,$.这就是说,我们必须所积分上限换为$\,\pi/2\,$.综上所述,这道题换元后的结果为:
$$
\int_0^{\sqrt[3]{\pi/2}}x^2\cos(x^3){\rm d}x = \frac{1}{3}\int_0^{\pi/2}\cos(t)\,{\rm d}t.
$$
我们很快就会完成道题目,但请注意如果把积分上限写成这样就大错特错了:
$$
\frac{1}{3}\int_0^{\sqrt[3]{\pi/2}}\cos(t)\,{\rm d}t.
$$
因为我们现在正在对$\,t\,$而不是$\,x\,$求积分,因此积分上下限也是以$\,t\,$为变量.事实上,我们可以以被积函数的变量为积分上下限的变量,从而使该积分更容易求解,像这样:
$$
\int_{x=0}^{x=\sqrt[3]{\pi/2}}x^2\cos(x^3){\rm d}x = \frac{1}{3}\int_{t = 0}^{t = \pi/2}\cos(t)\,{\rm d}t.
$$
这真的强调了我们正在做的事:当$\,x = 0\,$时,$\,t\,也为0;当\,x\,= \sqrt[3]{\pi/2}\,时,\,t = \pi/2\,.$所以我们总结一下,实际上有三次换元:

1. ${\rm d}x$ -- 要用$\,{\rm d}t\,$来表示它,可以借用被积函数里的其他带有$\,x\,$的项来做相应的变化;
2. 把被积函数里所有带有$\,x\,$的项都使用$\,t\,$来表示;
3. 积分上下限也使用$\,t\,$来表示.

让我们来完成这道题目.最好的方法是把计算过程写在左边,像这样:
$$
\begin{array}{l|l}
t = x^3 & \int_0^{\sqrt[3]{\pi/2}}x^2 \cos(x^3){\rm d}x = \frac{1}{3}\int_0^{\pi/2}\cos(t)\,{\rm d}t.\\
{\rm d}t = 3x^2{\rm d}x,所以x^2{\rm d}x = \frac{1}{3}{\rm d}t & \qquad\quad = \frac{1}{3} \sin(t)|_0^{\pi/2}\\
当x=0时,t=0\\ 当x=\sqrt[3]{\pi/2},t = \pi/2&\qquad \quad =\left(\frac{1}{3}\sin(\pi/2) \right) -\left(\frac{1}{3}\sin(0)\right) = \frac{1}{3}.\\
\end{array}
$$

#### 18.1.2 如何换元
$$
\begin{array}{||}
\hline
\\
在换掉\,\sqrt[n]{ax+b}\,之前,设\,t=\sqrt[n]{ax+b}\,并对等式\,t^n=ax+b\,两端求导.\\
\\
\hline
\end{array}
$$

- 对于** 不定积分 **,用$\,t\,和\,{\rm d}t\,$分别表示带有$\,x\,的表达式和\,{\rm d}x\,$,然后再求这个新的用$\,t\,$表达的积分,最后再挽回到$\,x\,$;

- 对于** 定积分 **,用$\,t\,和\,{\rm d}t\,$分别表达带有$\,x\,$的表达式和$\,{\rm d}x\,$,** 并且 **也要把积分的上下限换为与$\,t\,$相关,这时计算这个新的积分(没必要再回到以$\,x\,$为变量的状态).当然也可以用另一个方法,就是先把它们看成不定积分去计算结果,然后再把积分上下限分别代入求最后的结果.

#### 18.1.3 换元法的理论解释
### 18.2 分部积分法
$$
\begin{array}{||}
\hline
\,\int u{\rm d}v = uv - \int v{\rm d}u.\,\\
\hline
\end{array}
$$
$$
\begin{array}{cccccccccc}
\int&u&{\rm d}v& = & u&v& -&\int&v&{\rm d}u\\
\int&\cos(x)&\overbrace{e^{2x}{\rm d}x}&=&\cos(x)&\overbrace{\frac{1}{2}e^{2x}}& -&\int&\overbrace{\frac{1}{2}e^{2x}}&\overbrace{(-\sin(x)){\rm d}x}\\
&&&=& &&&&&\\
\end{array}
$$
### 18.3 部分分式
#### 18.3.1 部分分式的代数运算
我们的目的是把一个有理函数分成许多更简单的部分.第一步是确保这个函数的分子的次数小于分母的次数.如果不是这样,我们需要先做一个多项式除法.所以在下面这些例子中:
$$
\int \frac{x+2}{x^2-1}{\rm d}x\quad 和\quad \int \frac{5x^2+x-3}{x^2-1}{\rm d}x.\\
$$
第一例很容易,因为很显然分子的次数小于分母的次数.但一第二个例子就不那么容易了,因为分子的次数同分母一样(都是2).如果分子是三次或者更高次,那我们会有同样的麻烦.这样的话,我们需要做一个多项式除法.为此,将其写为
$$
\large分母 \enclose{longdiv}{分子}.\\
$$
来看我们的例子
$$
\int \frac{5x^2+x-3}{x^2-1}{\rm d}x,\\
\large\\
\frac{5x^2+x-3}{x^2-1} = 5 + \frac{x+2}{x^2-1}.\\
$$
如果等式两边同时对$\,x\,$积分,我们有
$$
\int \frac{5x^2+x-3}{x^2-1}{\rm d}x={\large\int} \left (5+\cfrac{x+2}{x^2-1}\right){\rm d}x.\\
$$
现在,我们能把这个积分分成了两部分,并且对第一部分求积分,我们看到原始的积分变为
$$
\large\int 5{\rm d}x + \int \frac{x+2}{x^2-1}{\rm d}x = 5x + \int \frac{x+2}{x^2-1}{\rm d}x.\\
$$
这个新积分的分子次数为1,分母次数为2,这正是我们想要的结果.现在我们可以继续计算了.
接下来,我们将要分解分母中的因式.如果分母是一个二次函数,请检验它的判别式:像在1.6节中那样,如果判别式为负,你不能对它进行因式分解.否则,可以手动进行因式分解或使用二次公式.如果分母很复杂,你就不得不猜想一个根,然后再用多项式除法.
在因式分解分母之后,下一步要写下的东西叫做"分部".这是通过把分母的一个或更多的因式加到一起构成的,它住所如下形式:
1. 如果有线性式$\,(x+a)\,$, 那么这个分部有如下形式:
$$
\frac{A}{x+a}.\\
$$
2. 如果有线性式的平方$\,(x+a)^2\,$, 那么这个分部有如下形式:
$$
\cfrac{A}{(x+a)^2} + \cfrac{B}{x+a}.
$$
3. 如果有二次多项式$\,(x^2+ax+b)\,$, 那么这个分部有如下形式:
$$
\frac{Ax+B}{x^2+ax+b}.\\
$$

这些都是常见的例子.也有一些不常见的例子,
4. 如果有线性式的三次方$\,(x+a)^3\,$, 那么这个分部有如下形式:
$$
\cfrac{A}{(x+a)^3} +
\cfrac{B}{(x+a)^2} +
\cfrac{C}{x+a}.\\
$$
5. 如果有线性式的四次方$\,(x+a)^4\,$,那么这个分部有如下形式:
$$
\cfrac{A}{(x+a)^4} +
\cfrac{B}{(x+a)^3} +
\cfrac{C}{(x+a)^2} +
\cfrac{D}{x+a}.\\
$$

注意:** 分部仅仅由分母决定 **, 同分子没有关系!并且当我们使用常数$A,B,C,D$时,记住不能在不同的表达式里重复使用这些字母.所以,你需要使用字母表中后续的字母.在刚才的例子
$$
\int \frac{x+2}{x^2-1}{\rm d}x.
$$
中,分母是$\,(x+1)(x-1)\,$;所以我们有两个线性因子,分部为:
$$
\frac{A}{x-1} +
\frac{B}{x+1}.\\
$$
我们不能两次使用$\,A\,$, 所以在第二项使用$\,B\,$.顺便说一下,如果你使用字母$\,C_1,C_2,C_3\,$或者其它字母,而不是使用$\,A,B,C\,$等字母, 那么是在玩火自焚.如果这样做, 那你会经常犯一些不经意的错误,除非你注意到这些字母下脚标的不同.

这里还有另外一个例子.
$$
\large\cfrac{任意陈旧形式}{(x-1)(x+4)^3(x^2+4x+7)(3x^2-x+1)}
$$
这种形式会怎样呢?答案是
$$
\large
\cfrac{A}{x-1}+
\cfrac{B}{(x+4)^3}+
\cfrac{C}{(x+4)^2}+
\cfrac{D}{x+4}+
\cfrac{Ex+F}{x^2+4x+7}+
\cfrac{Gx+H}{3x^2-x+1}\\
$$
你可能全以不同的顺序写上这些项,或者交换从$\,A\,到\,H\,$这些字母的顺序; 这都可以.
一旦写下这种形式, 你也应该写下被积函数等于这各占形式,然后再使用等式两端同时乘以分母的方法.例如,我们发现积分
$$
\int \frac{x+2}{x^2-1}{\rm d}x
$$
的被积函数可以写为
$$
\frac{A}{x-1} +
\frac{B}{x+1}.\\
$$
所以我们有
$$
\frac{x+2}{x^2-1}= \frac{A}{x-1} + \frac{B}{x+1}.
$$
实际上,最好把等式左侧的分工写为
$$
\frac{x+2}{(x-1)(x+1)}= \frac{A}{x-1} + \frac{B}{x+1}.
$$
现在等式两侧同时乘以分母可得
$$
x+2 = A(x+1)+B(x-1).
$$
注意,等式右侧的第一项消掉了$\,x-1\,$因子, 第二侧削掉了$\,x+1\,$因子.无论如何,现在我们有两个方法继续.第一个方法是替代$\,x\,$. 如果设$\,x=1\,,$这里$B(x-1)$这项就消失了,这时我们有
$$
1+2 = A(1+1).
$$
也就是说$A=\cfrac{3}{2}$.现在如果你把$x=-1$代入原始方程,那么$A(x+1)$这项将会消失:
$$
-1+2 = B(-1-1).
$$
所以$B=-\cfrac{1}{2}$. 另一个求解$A和B$的方法,是将原始方程$x+2 = A(x+1)+B(x-1)$,重写为
$$
x+2 = (A+B)x + (A-B).
$$
现在通过x的系数相等可得$1 = A+B$,通常常数项相等可得$2=A-B$. 同时解这两个方程,可得$A=\cfrac{3}{2}, B=-\cfrac{1}{2}$,同刚才的答案一致.

我们剩下的工作是重写积分表达式(用分部的形式), 但这次需要把常数代进去. 所以我们的例子为
$$
\frac{x+2}{x^2-1}
= \frac{A}{x-1} + \frac{B}{x+1}
= \frac{3/2}{x-1} + \frac{-1/2}{x+1}.
$$
现在对等式两端同时积分,并把常数项移到等式的外边, 可得
$$
\int \frac{x+2}{x^2-1}{\rm d}x=
\frac{3}{2}\int \frac{1}{x-1}{\rm d}x - \frac{1}{2}\int \frac{1}{x+1}{\rm d}x.
$$

#### 18.3.2 对每一部分积分

#### 18.3.3 方法和一个完整的例子
有理函数积分的完整方法.

1. -- ** 先看分子分母的最高项的次数,如有必要请做除法. **查看分子的次数是否小于分母次数.如果是,那你运气好,直接进入第二步;如果不是,就要做一个多项式的除法了,然后再进入第二步.

2. -- ** 对分母进行因式分解. **使用二次公式或猜想一个结果,然后再做除法,以便因式分解被积分的分母.

3. -- ** 分部. ** 就像之前描述的那样,分别写出带有未知常数的"分部".写下一个像这样的等式:
$$
被积函数= 分部.
$$

4. -- ** 计算常数的值. **把方程的两连同时乘以分母,通过任一方法计算常数的值:(a)换掉$x$的值;(b)系数相等法;或者结合使用(a)和(b)两种方法.现在你能用几个有理数的和来来表示这个被积函数,这些有理函数可能是分子为常数分母为线性函数的幂,或者分子为线性函数分母为二次函数.

5. -- ** 求解分母为线性项次幂的积分. **求解分母是线性函数次幂的积分.答案将会是对数形式或该线性项的负次幂.

6. -- ** 对分母是二次函数的被积函数求积分. **对于分母是二次函数且不能因式分解的被积函数求积分,先配方,然后换元,再把它尽可能分解为两个积分.前者会涉及对数,而第二个会涉及正切函数的反函数.如果仅仅有一人积分,它可能是对数形式又可能是正切函数的反函数形式.这个公式通常是非常实用的:
$$
\begin{array}{||}
\hline
\int \frac{1}{t^2+a^2}{\rm d}t = \frac{1}{a}\tan^{-1}(\frac{t}{a})+C.\\
\hline
\end{array}
$$
